That printf call looks dangerous too...